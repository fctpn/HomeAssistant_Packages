homeassistant:
  # Two factor authentication
  auth_mfa_modules:
    - type: notify
      message: 'Codul de acces este: {}'
    - type: totp
      name: Authenticator app

recorder:
  # Set recorder to use MariaDB
  db_url: !secret recorder_db_url
  purge_keep_days: !secret recorder_keep_days
  exclude:
    entities:
      - automation.healthchecks
http:
  # Setup NGINX
  use_x_forwarded_for: true
  trusted_proxies:
    - 172.30.33.0/24
    
rest_command:
  # monitorizare server with healthchecks.io
  healthchecks:
    url: !secret healthchecks
      

sensor:
    # monitorizare server rpi
  - platform: systemmonitor
    resources:
     - type: processor_use
     - type: swap_use_percent
     - type: processor_temperature
     - type: load_15m
     - type: memory_use_percent
     - type: disk_use_percent
       arg: /
     - type: disk_use
       arg: /
     - type: load_15m
  - platform: uptime
    name: Time Online
  
    # size of MariaDB
  - platform: sql
    db_url: !secret db_url
    queries:
      - name: 'DataBase size'
        query: !secret db_query 
        column: 'value'
        unit_of_measurement: MB   



automation:
    # Notify on server start using defined service
  - id: 'server_start'
    alias: Server Start
    description: ''
    trigger:
    - platform: homeassistant
      event: start
    condition: []
    action:
    - service: !secret notify_service
      data:
        message: ðŸ¦¾ Serverul a pornit!
    mode: single
    
    # Ping healthchecks.io every minute
  - id: 'healthchecks_update'
    alias: HealthChecks
    description: ''
    trigger:
      - platform: time_pattern
        minutes: /1
    condition: []
    action:
      - service: rest_command.healthchecks
    mode: single

